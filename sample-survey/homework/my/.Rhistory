'Area'=c(322.57,197.81),
'Number of tows made'=c(8,5),
'Average number of bushels per tow'=c(0.63,0.40),
'Sample variance for stratum'=c(0.083,0.046))
t_hat2 <- 25 * sum(data2$Number.of.tows.made*data2$Average.number.of.bushels.per.tow)
SE_t_hat<- sqrt(sum((data$Sample.variance.for.stratum/data$Area) * (1-0.04) * (data$Area*25)^2))
data2 <- data.frame('Stratum' = c(1,4),
'Area'=c(322.57,197.81),
'Number of tows made'=c(8,5),
'Average number of bushels per tow'=c(0.63,0.40),
'Sample variance for stratum'=c(0.083,0.046))
t_hat2 <- 25 * sum(data2$Number.of.tows.made*data2$Average.number.of.bushels.per.tow)
SE_t_hat_2<- sqrt(sum((data$Sample.variance.for.stratum/data$Area) * (1-0.04) * (data$Area*25)^2))
SE_t_hat_2
t_hat <- sum(25 * data$Area * data$Average.number.of.bushels.per.tow)
t_hat
SE_t_hat<- sqrt(sum((data$Sample.variance.for.stratum/data$Area) * (1 - 0.04) * (data$Area*25)^2))
SE_t_hat
data2 <- data.frame('Stratum' = c(1,4),
'Area'=c(322.57,197.81),
'Number of tows made'=c(8,5),
'Average number of bushels per tow'=c(0.63,0.40),
'Sample variance for stratum'=c(0.083,0.046))
t_hat_2 <- sum(25 * data$Area * data$Average.number.of.bushels.per.tow)
SE_t_hat_2<- sqrt(sum((data2$Sample.variance.for.stratum/data2$Area) * (1 - 0.04) * (data2$Area*25)^2))
SE_t_hat_2
?agsrs
??agsrs
library(SDaA)
agsrs
agsrs
n < -nrow(agsrs)
n <- nrow(agsrs)
n
N <- 3078
t_x <- sum(agsrs$farms87)
t_x
x_u_bar <- 2087759 / N
x_u_bar
x_bar <- agsrs$farms87 / n
x_bar
x_bar <- sum(agsrs$farms87) / n
x_batr
x_bar
t_hat <- (x_u_bar / x_bar) * agsrs$farms92
t_hat
t_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
t_hat
B_hat <- mean(agsrs$farms92) / mean(agsrs$acres87)
SE_t_hat <- (t_x / (n-1)) * sum(agsrs$farms92 - B_hat * agsrs$farms87)
SE_t_hat
SE_t_hat <- (t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2)
SE_t_hat
B_hat
N <- 3078
n <- nrow(agsrs)
t_x <- 2087759
x_u_bar <- t_x / N
x_bar <- sum(agsrs$farms87) / n
t_y_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
B_hat <- mean(agsrs$farms92) / mean(agsrs$farms87)
SE_t_hat <- (t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2)
N <- 3078
n <- nrow(agsrs)
t_x <- 2087759
x_u_bar <- t_x / N
x_bar <- sum(agsrs$farms87) / n
t_y_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
B_hat <- mean(agsrs$farms92) / mean(agsrs$farms87)
SE_t_hat <- (t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2)
t_y_hat ; SE_t_hat
N <- 3078
n <- nrow(agsrs)
t_x <- 2087759
x_u_bar <- t_x / N
x_bar <- sum(agsrs$farms87) / n
t_y_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
B_hat <- mean(agsrs$farms92) / mean(agsrs$farms87)
SE_t_hat <- sqrt((t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2))
t_y_hat ; SE_t_hat
N <- 3078
n <- nrow(agsrs)
t_x <- 2087759
x_u_bar <- t_x / N
x_bar <- sum(agsrs$farms87) / n
t_y_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
B_hat <- mean(agsrs$farms92) / mean(agsrs$farms87)
SE_t_hat <- sqrt((t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2))
t_y_hat
t_y_hat + c(-qnorm(0.975),qnorm(0.975)) * SE_t_hat
library(SDaA)
N <- 3078
n <- nrow(agsrs)
t_x <- 2087759
x_u_bar <- t_x / N
x_bar <- sum(agsrs$farms87) / n
t_y_hat <- (x_u_bar / x_bar) * sum(agsrs$farms92)
B_hat <- mean(agsrs$farms92) / mean(agsrs$farms87)
SE_t_hat <- sqrt((t_x / (n-1)) * sum((agsrs$farms92 - B_hat * agsrs$farms87)^2))
t_y_hat
t_y_hat + c(-qnorm(0.975),qnorm(0.975)) * SE_t_hat
fit <- lm(agsrs$farms92~agsrs$acres87)
fit <- lm(agsrs$farms92~agsrs$acres87)
fit
fit <- lm(agsrs$farms92~agsrs$acres87)
summary(fit)
fit$coefficients
fit$model
fit$residuals
summary(fit)
summary(fit)$Coefficients
fit
fit$assign
fit$qr
fit$df.residual
fit$terms
fit <- lm(sum(agsrs$farms92)~sum(agsrs$acres87))
summary(fit)
fit <- lm(agsrs$farms92~agsrs$acres87)
summary(fit)
setwd("~/Desktop/study/subjects/sample survey/homework/my")
data <- read.csv('clustersamp.csv.xls')
data
knitr::opts_chunk$set(echo = TRUE)
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:4){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
t_hats
length(t_hats)
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
t_hats
E_t_hat = mean(t_hats)
E_t_hat
v_t_hat = var(t_hats)
v_t_hat
for (j in 4:4) {print(j)}
E_t_hatï¼›v_t_hat
E_t_hat;v_t_hat
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
?var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = sd(t_hats)^2
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
print(i,j)
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
i_list = c()
j_list = c()
for (i in 1:3){
for (j in (i+1):4){
i_list = c(i_list,i)
j_list = c(j_list,j)
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
i_list
j_list
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats) *((N-1)/N)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
v_t_hat = sum((t_hats - E_t_hat)^2 / N)
v_t_hat
t_hats - E_t_hat
t_hats
E_t_hat
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = sum((t_hats - E_t_hat)^2 / N)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = sum((t_hats - E_t_hat)^2 ) / N
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
var(t_hats)
var(t_hats) * ((N-1)/N)
var(t_hats) * (N/(N-1))
N = 100 # number of clusters
n = 5 # number of cluster to sample
M = 8 # number of item in ith cluster and same as m in one stage cluster
M0 = sum(rep(M,N))
yi_bar = rep(c(3,2,0),c(2,1,2)) / M
ti_hat = M * yi_bar
tunb_hat = (N/n) * sum(ti_hat)
s_t = sqrt((1/(n-1)) * sum((ti_hat - tunb_hat/N) ^ 2))
se_t = N * s_t / sqrt(n) * sqrt(1 - n/N)
tunb_hat ; se_t
N = 800
n = 40
y = rep(c(1,0),c(8,n-8))
ys_bar =  sum(y) / n
t_hat = N * ys_bar
ss_2 = (1/n) * sum((y - ys_bar)^2)
se_t = sqrt(N^2 *(ss_2/n) * (1-n/N))
t_hat; se_t
N = 20 # number of cluseter
n = 4  # number of cluseter be sampled
M0 = 940 # total population size
Mi = c(17,56,23,64) # cluster size
mi = c(10,25,12,30) # sample size in step two
yi_bar = c(32.7,36.1,30.3,33.4)  # cluster sample mean
si_2 = c(26.3,21.4,23.6,29.1)    # cluster sample variance
ti_hat = Mi * yi_bar
tunb_hat = (N/n) * sum(ti_hat)
yunb_hat = tunb_hat / M0
st_2 = (1/(n-1)) * sum((ti_hat - tunb_hat/N)^2)
se_tunb_hat = sqrt(N^2*(st_2/n)*(1-n/N)+sum(((si_2*Mi^2)/mi)*(1 - mi/Mi)))
se_yunb_hat = se_tunb_hat / M0
yunb_hat;se_yunb_hat
yr_bar_hat = ((N/n) * sum(ti_hat))/((N/n) * sum(Mi))
sr_2 = (1/(n-1)) * sum(Mi^2 * (yi_bar - yr_bar_hat)^2)
se_yr_bar_hat = sqrt((sr_2/(n * mean(Mi)^2)) * (1 - n/N) + (1/(n*N*mean(Mi)^2)) * sum(si_2*(Mi^2/mi) *(1-mi/Mi)))
yr_bar_hat;se_yr_bar_hat
Mi = c(110,265,360,1265)
Sales = c(44,82,112,362)
M0 = sum(Mi)
phi = Mi / M0
N = 4
n = 2
# every draw is independent
E_tphi_hat = 0
for ( i in 1:N){
for ( j in 1:N){
tphi_hat = (1/n) * sum((Sales[i]/phi[i]),(Sales[j]/phi[j]))
E_tphi_hat = E_tphi_hat + phi[i] * phi[j] * tphi_hat
}
}
E_tphi2_hat = 0
for ( i in 1:N){
for ( j in 1:N){
tphi2_hat = ((1/n) * sum((Sales[i]/phi[i]),(Sales[j]/phi[j])))^2
E_tphi2_hat = E_tphi2_hat + phi[i] * phi[j] * tphi2_hat
}
}
v_tphi_hat = E_tphi2_hat - E_tphi_hat^2
E_tphi_hat;v_tphi_hat
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = sum((t_hats - E_t_hat)^2 ) / N
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats) * ((N-1)/N)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats) * ((N-1)/N)
E_t_hat;v_t_hat
S.2<-var(y.i) * ((N-1)/N)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats)
E_t_hat;v_t_hat
S.2<-var(y.i) * ((N-1)/N)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
}
}
E_t_hat = mean(t_hats)
v_t_hat = var(t_hats)
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
S.2<-var(y.i)
S.2
N=4
n=2
t_hats = c()
y.i<-c(44,82,112,362)
t_hats_2 = c()
for (i in 1:3){
for (j in (i+1):4){
y1 = y.i[i]
y2 = y.i[j]
y_bar = mean(c(y1,y2))
t_hat = N * y_bar
t_hats = c(t_hats,t_hat)
t_hats_2 = c(t_hats_2,t_hat^2)
}
}
E_t_hat = mean(t_hats)
v_t_hat = mean(t_hats_2) - E_t_hat^2
E_t_hat;v_t_hat
S.2<-var(y.i)
t.srs.var<-N^2*(1-n/N)*S.2/n
t.srs.var
