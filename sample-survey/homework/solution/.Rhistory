W_data <- agstrat$acres87[which(agstrat$region=='W')]
N_h <- c(1054,220,1382,442)
n_h <- c(103,21,135,41)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 442 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
sd_srs / sd_strtified
sqrt(var_h)
sqrt(var_h) * N_h
allocation <- sqrt(var_h) * N_h
allocation <- sqrt(var_h) * N_h
allocation
for (i in 1:4){
print(round(allocation[i]/sum(allocation)*300))
}
67 + 8 + 123 + 101
agpop
dim(agpop)
set.seed(5234)
NC_data <- sample(agpopt$acres87[which(agstrat$region=='NC')], 67)
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agstrat$region=='NC')], 67)
NE_data <- sample(agpop$acres87[which(agstrat$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agstrat$region=='S')],123)
W_data <- sample(agpop$acres87[which(agstrat$region=='W')],101)
agstrat$region=='W'
sum(agstrat$region=='W')
agpop
dim(agpop)
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 67)
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agpop$region=='S')],123)
W_data <- sample(agpop$acres87[which(agpop$region=='W')],101)
N_h <- c(1054,220,1382,442)
n_h <- c(67,9,123,101)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 442 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
p_hat <- 7/18 * 0.45 + 9/18 * 0.25 + 2/18 * 0.12
n <- sum(n_h)
v_srs_p_srs_hat <- (1-n/N[1]) * ((p_hat*(1-p_hat)) /(n-1))
v_srs_p_srs_hat
v_srs_p_srs_hat / v_prop_p_str_hat
referred_publications <- c(0,1,2,3,4,5,6,7,8,9,10)
faculty_members <- c(28,4,3,4,4,2,1,0,2,1,1)
data <- rep(referred_publications,faculty_members)
N <- 807
n <- 50
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
referred_publications <- c(0,1,2,3,4,5,6,7,8,9,10)
faculty_members <- c(28,4,3,4,4,2,1,0,2,1,1)
data <- rep(referred_publications,faculty_members)
N <- 807
n <- 50
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 67)
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agpop$region=='S')],123)
W_data <- sample(agpop$acres87[which(agpop$region=='W')],101)
N_h <- c(1054,220,1382,442)
n_h <- c(67,9,123,101)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 442 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified_new <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
sd_strtified / sd_strtified_new
otters
dim(otters)
data_1 <- otters$holts[which(otters$habitat == 1 )]
data_2 <- otters$holts[which(otters$habitat == 2 )]
data_3 <- otters$holts[which(otters$habitat == 3 )]
data_4 <- otters$holts[which(otters$habitat == 4 )]
N_h <- c(89,61,40,47)
n_h <- c(19,20,22,21)
mean_1 <- mean(data_1)
mean_2 <- mean(data_2)
mean_3 <- mean(data_3)
mean_4 <- mean(data_4)
var_1 <- var(mean_1)
var_2 <- var(mean_2)
var_3 <- var(mean_3)
var_4 <- var(mean_4)
var_h <- c(var_1,var_2,var_3,var_4)
t_hat_1 <- N_h[1] * mean_1
t_hat_2 <- N_h[1] * mean_2
t_hat_3 <- N_h[1] * mean_3
t_hat_4 <- N_h[1] * mean_4
t_hat <- t_hat_1 + t_hat_2 + t_hat_3 + t_hat_4
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
data_1 <- otters$holts[which(otters$habitat == 1 )]
data_2 <- otters$holts[which(otters$habitat == 2 )]
data_3 <- otters$holts[which(otters$habitat == 3 )]
data_4 <- otters$holts[which(otters$habitat == 4 )]
N_h <- c(89,61,40,47)
n_h <- c(19,20,22,21)
mean_1 <- mean(data_1)
mean_2 <- mean(data_2)
mean_3 <- mean(data_3)
mean_4 <- mean(data_4)
var_1 <- var(mean_1)
var_2 <- var(mean_2)
var_3 <- var(mean_3)
var_4 <- var(mean_4)
var_h <- c(var_1,var_2,var_3,var_4)
t_hat_1 <- N_h[1] * mean_1
t_hat_2 <- N_h[1] * mean_2
t_hat_3 <- N_h[1] * mean_3
t_hat_4 <- N_h[1] * mean_4
t_hat <- t_hat_1 + t_hat_2 + t_hat_3 + t_hat_4
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
var_h
data_1 <- otters$holts[which(otters$habitat == 1 )]
data_2 <- otters$holts[which(otters$habitat == 2 )]
data_3 <- otters$holts[which(otters$habitat == 3 )]
data_4 <- otters$holts[which(otters$habitat == 4 )]
N_h <- c(89,61,40,47)
n_h <- c(19,20,22,21)
mean_1 <- mean(data_1)
mean_2 <- mean(data_2)
mean_3 <- mean(data_3)
mean_4 <- mean(data_4)
var_1 <- var(data_1)
var_2 <- var(data_2)
var_3 <- var(data_3)
var_4 <- var(data_4)
var_h <- c(var_1,var_2,var_3,var_4)
t_hat_1 <- N_h[1] * mean_1
t_hat_2 <- N_h[1] * mean_2
t_hat_3 <- N_h[1] * mean_3
t_hat_4 <- N_h[1] * mean_4
t_hat <- t_hat_1 + t_hat_2 + t_hat_3 + t_hat_4
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
N <- 90000
N_h <- c(35000,45000,10000)
n_h <- c(504,324,72)
p_h_hat <- c(0.45,0.25,0.12)
v_prop_p_str_hat <- sum((1-n_h/N_h) * (N_h/N)^2 * (p_h_hat*( 1 - p_h_hat))/(n_h -1))
v_prop_p_str_hat
p_hat <- 7/18 * 0.45 + 9/18 * 0.25 + 2/18 * 0.12
n <- sum(n_h)
v_srs_p_srs_hat <- (1-n/N[1]) * ((p_hat*(1-p_hat)) /(n-1))
v_srs_p_srs_hat
v_srs_p_srs_hat / v_prop_p_str_hat
knitr::opts_chunk$set(echo = TRUE)
NC_data <- agstrat$acres87[which(agstrat$region=='NC')]
knitr::opts_chunk$set(echo = TRUE)
N <- 90000
N_h <- c(35000,45000,10000)
n_h <- c(350,450,100)
p <- c(0.45,0.25,0.12)
v_prop_p_str_hat <- sum(((N_h-n_h)/(N_h-1)) * (N_h/N)^2 * (p*( 1 - p))/(n_h))
v_prop_p_str_hat
p <- 7/18 * 0.45 + 9/18 * 0.25 + 2/18 * 0.12
n <- sum(n_h)
v_srs_p_srs_hat <- ((N-n)/(N-1)) * ((p*(1-p)) /(n))
v_srs_p_srs_hat
v_srs_p_srs_hat / v_prop_p_str_hat
referred_publications <- c(0,1,2,3,4,5,6,7,8,9,10)
faculty_members <- c(28,4,3,4,4,2,1,0,2,1,1)
data <- rep(referred_publications,faculty_members)
N <- 807
n <- 50
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
## acres87 denote number of acres devoted to farms in 1987
library(SDaA)
data <- agsrs$acres87
N <- 3078
n <- 300
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
sd_srs <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
NC_data <- agstrat$acres87[which(agstrat$region=='NC')]
NE_data <- agstrat$acres87[which(agstrat$region=='NE')]
S_data <- agstrat$acres87[which(agstrat$region=='S')]
W_data <- agstrat$acres87[which(agstrat$region=='W')]
N_h <- c(1054,220,1382,422)
n_h <- c(103,21,135,41)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
NC_data
NE_data
S_data
W_data
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agpop$region=='S')],125)
W_data <- sample(agpop$acres87[which(agpop$region=='W')],98)
N_h <- c(1054,220,1382,422)
n_h <- c(68,9,125,98)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified_new <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
NC_data
NE_data
S_data
W_data
?count
??count
n_missing <- c(sum(NC_data==-99),sum(NE_data==-99),sum(S_data==-99),sum(W_data==-99))
n_missing
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)[which(sample(agpop$acres87[which(agpop$region=='NC')], 68) > 0]
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)[which(sample(agpop$acres87[which(agpop$region=='NC')], 68) > 0)]
NC_data
n_h <- c(length(NC_data),length(NE_data),length(S_data),length(W_data))
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)[which(sample(agpop$acres87[which(agpop$region=='NC')], 68) > 0)]
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)[which(sample(agpop$acres87[which(agpop$region=='NE')],9) > 0)]
S_data <- sample(agpop$acres87[which(agpop$region=='S')],125)[which(sample(agpop$acres87[which(agpop$region=='S')],125) > 0)]
W_data <- sample(agpop$acres87[which(agpop$region=='W')],98)[which(sample(agpop$acres87[which(agpop$region=='W')],98) > 0)]
N_h <- c(1054,220,1382,422)
n_h <- c(length(NC_data),length(NE_data),length(S_data),length(W_data))
n_h
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)[which(sample(agpop$acres87[which(agpop$region=='NC')], 68) > 0)]
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)[which(sample(agpop$acres87[which(agpop$region=='NE')],9) > 0)]
S_data <- sample(agpop$acres87[which(agpop$region=='S')],125)[which(sample(agpop$acres87[which(agpop$region=='S')],125) > 0)]
W_data <- sample(agpop$acres87[which(agpop$region=='W')],98)[which(sample(agpop$acres87[which(agpop$region=='W')],98) > 0)]
N_h <- c(1054,220,1382,422)
n_h <- c(length(NC_data),length(NE_data),length(S_data),length(W_data))
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified_new <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
W_data
NC_data <- NC_data[which(NC_data>0)]
NE_data <- NE_data[which(NE_data)>0]
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agpop$region=='S')],125)
W_data <- sample(agpop$acres87[which(agpop$region=='W')],98)
NC_data <- NC_data[which(NC_data>0)]
NE_data <- NE_data[which(NE_data>0)]
S_data <- S_data[which(S_data>0)]
W_data <- W_data[which(W_data>0)]
N_h <- c(1054,220,1382,422)
n_h <- c(length(NC_data),length(NE_data),length(S_data),length(W_data))
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified_new <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
n_h
data_1 <- otters$holts[which(otters$habitat == 1 )]
data_2 <- otters$holts[which(otters$habitat == 2 )]
data_3 <- otters$holts[which(otters$habitat == 3 )]
data_4 <- otters$holts[which(otters$habitat == 4 )]
N_h <- c(89,61,40,47)
n_h <- c(19,20,22,21)
mean_1 <- mean(data_1)
mean_2 <- mean(data_2)
mean_3 <- mean(data_3)
mean_4 <- mean(data_4)
var_1 <- var(data_1)
var_2 <- var(data_2)
var_3 <- var(data_3)
var_4 <- var(data_4)
var_h <- c(var_1,var_2,var_3,var_4)
t_hat_1 <- N_h[1] * mean_1
t_hat_2 <- N_h[2] * mean_2
t_hat_3 <- N_h[3] * mean_3
t_hat_4 <- N_h[4] * mean_4
t_hat <- t_hat_1 + t_hat_2 + t_hat_3 + t_hat_4
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
sd_strtified / sd_strtified_new
knitr::opts_chunk$set(echo = TRUE)
(sd_srs / sd_strtified)^2
knitr::opts_chunk$set(echo = TRUE)
N <- 90000
N_h <- c(35000,45000,10000)
n_h <- c(350,450,100)
p <- c(0.45,0.25,0.12)
v_prop_p_str_hat <- sum(((N_h-n_h)/(N_h-1)) * (N_h/N)^2 * (p*( 1 - p))/(n_h))
v_prop_p_str_hat
p <- 7/18 * 0.45 + 9/18 * 0.25 + 2/18 * 0.12
n <- sum(n_h)
v_srs_p_srs_hat <- ((N-n)/(N-1)) * ((p*(1-p)) /(n))
v_srs_p_srs_hat
v_srs_p_srs_hat / v_prop_p_str_hat
referred_publications <- c(0,1,2,3,4,5,6,7,8,9,10)
faculty_members <- c(28,4,3,4,4,2,1,0,2,1,1)
data <- rep(referred_publications,faculty_members)
N <- 807
n <- 50
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
## acres87 denote number of acres devoted to farms in 1987
library(SDaA)
data <- agsrs$acres87
N <- 3078
n <- 300
y_bar_s <- mean(data)
t_hat <- N * y_bar_s
s <- sd(data)
sd_t_hat <- N * (s / sqrt(n)) * sqrt(1-n/N)
sd_srs <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
NC_data <- agstrat$acres87[which(agstrat$region=='NC')]
NE_data <- agstrat$acres87[which(agstrat$region=='NE')]
S_data <- agstrat$acres87[which(agstrat$region=='S')]
W_data <- agstrat$acres87[which(agstrat$region=='W')]
N_h <- c(1054,220,1382,422)
n_h <- c(103,21,135,41)
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
(sd_srs / sd_strtified)^2
allocation <- sqrt(var_h) * N_h
allocation
for (i in 1:4){
print(round(allocation[i]/sum(allocation)*300))
}
set.seed(5234)
NC_data <- sample(agpop$acres87[which(agpop$region=='NC')], 68)
NE_data <- sample(agpop$acres87[which(agpop$region=='NE')],9)
S_data <- sample(agpop$acres87[which(agpop$region=='S')],125)
W_data <- sample(agpop$acres87[which(agpop$region=='W')],98)
NC_data <- NC_data[which(NC_data>0)]
NE_data <- NE_data[which(NE_data>0)]
S_data <- S_data[which(S_data>0)]
W_data <- W_data[which(W_data>0)]
N_h <- c(1054,220,1382,422)
n_h <- c(length(NC_data),length(NE_data),length(S_data),length(W_data))
NC_mean <- mean(NC_data)
NE_mean <- mean(NE_data)
S_mean <- mean(S_data)
W_mean <- mean(W_data)
NC_var <- var(NC_data)
NE_var <- var(NE_data)
S_var <- var(S_data)
W_var <- var(W_data)
var_h <- c(NC_var,NE_var,S_var,W_var)
NC_t_hat <- 1054 * NC_mean
NE_t_hat <- 220 * NE_mean
S_t_hat <- 1382 * S_mean
W_t_hat <- 422 * W_mean
t_hat <- NC_t_hat + NE_t_hat + S_t_hat + W_t_hat
sd_t_hat <- sqrt(sum((1 - n_h/N_h) * (N_h ^2) * (var_h/n_h)))
sd_strtified_new <- sd_t_hat
uppder_bond <- t_hat + qnorm(0.975) * sd_t_hat
lower_bond <- t_hat + qnorm(0.025) * sd_t_hat
lower_bond;uppder_bond
(sd_strtified / sd_strtified_new) ^2
