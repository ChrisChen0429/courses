---
title: "Homework11"
author: "Yi Chen"
date: "4/10/2020"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Homework 11

In this homework, I will use the sport data.

```{r}
# load the data set
sport_name <- c("FOOTBALL","BASEBALL","BASKETBALL","TENNIS","CANOEING","SWIMMING","BOXING","VOLLEYBALL","SKIING","SURFING","FENCING","SKINDIVING","ARCHERY","PINGPONG","HORSEBACK","HIKING","BILLIARD","CAMPING","CHECKERS","JUMPROPE")
temp <- scan('SPORTS.txt')
sport <- matrix(NA, 19,19)
sport[upper.tri(sport, diag = TRUE)] <- temp
sport <- t(sport)
colnames(sport) <- sport_name[2:length(sport_name)]
rownames(sport) <- sport_name[1:(length(sport_name)-1)]
sport_dist <- dist(sport)
```

#### 1. fit an ultrametric tree to the data using the iterative projection method
```{r}
library(clue)
ultra_sport <- ls_fit_ultrametric(sport_dist,method=c("IP"), weights = 1, control = list())
plot(ultra_sport) # plots the fitted ultrametric tree

## squared distance
datvec=as.vector(sport_dist)
modvec=as.vector(ultra_sport)
cor(datvec,modvec)
```


#### 2. fit an additive tree to the data using the iterative projection method
```{r}
ultra_sport <- ls_fit_addtree(sport_dist,method=c("IP"), weights = 1, control = list())
plot(ultra_sport) # plots the fitted ultrametric tree

## squared distance
datvec=as.vector(sport_dist)
modvec=as.vector(ultra_sport)
cor(datvec,modvec)
```

The correlation increase with additive tree. The result of additive tree and ultrametric tree are also different. In ultrametric football and baseball are differnt from other sports. In the additive tree, football, baseball and other sports require speific enviornment (e.g., swiming pool) are categorized together.

#### I cannot install the GTREE in the mac system. 
